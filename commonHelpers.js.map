{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from \"axios\"; \n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"42148811-877485cb71de5bd48342bfa16\";\n\nconst form = document.querySelector(\"#form\");\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.button');\n\n\nlet page = 1;\nlet limit = 15;\nlet maxPages = 0;\n\n\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\nhideLoader()\nform.addEventListener(\"submit\", handleSearch);\n\nasync function handleSearch(event) {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n    const images = form.elements.images.value;\n    \n    gallery.innerHTML = '';\n\n    if (!images.trim()) {\n        iziToast.show({\n            message: `Please, fill in the search field`,                    \n            messageColor: 'white',\n            backgroundColor: '#EF4040',\n            position: 'topRight',\n            timeout: 4000,\n        });\n        return;\n    }\n    showLoader();\n                  \n            if (!images) {\n                iziToast.show({                   \n                    message: `Sorry, there are no images matching your search query.`,                    \n                    messageColor: 'white',\n                    backgroundColor: '#EF4040',\n                    position: 'topRight',\n                    timeout: 4000,\n                });\n                return;\n            }\n    try {\n        const {hits, totalHits} = await searchImages(images);        \n        maxPages = Math.ceil(totalHits / limit);\n            gallery.insertAdjacentHTML ('beforeend', createImagesMarkup(hits)) ;\n        lightbox.refresh();   \n        if (hits.length > 0 && hits.length !== totalHits) {\n            loadMoreBtn.classList.remove('is-hidden');\n            loadMoreBtn.addEventListener('click', handleLoadMore);\n        } else {\n            loadMoreBtn.classList.add('is-hidden');\n        }        \n    }       \n       catch(error) {\n      console.log(error);\n    }\n        finally {\n        form.reset();\n        hideLoader();\n      };\n\n  async function handleLoadMore() {  \n      showLoader();\n        page += 1;\n        loadMoreBtn.classList.add('is-hidden'); \n      try {\n        \n        const { hits } = await searchImages(images);\n        \n          gallery.insertAdjacentHTML('beforeend', createImagesMarkup(hits));\n        lightbox.refresh(); \n\n        const cardSize = gallery.getBoundingClientRect();  \n        window.scrollBy({ top: cardSize.height * 2, behavior: \"smooth\", })\n\n        // const card = document.querySelectorAll('.gallery-item');\n        // const cardSize = card.getBoundingClientRect();            \n        // window.scrollBy({ top: cardSize.height * 2, behavior: \"smooth\", });\n        \n        }catch(error) {\n      console.log(error);\n    }\n        finally {\n            loadMoreBtn.classList.remove('is-hidden');\n            if (page === maxPages) {\n                loadMoreBtn.classList.add('is-hidden');\n                loadMoreBtn.removeEventListener('click', handleLoadMore);\n                iziToast.show({                   \n                    message: `We're sorry, but you've reached the end of search results.`,                    \n                    messageColor: 'white',\n                    backgroundColor: '#EF4040',\n                    position: 'topRight',\n                    timeout: 4000,\n                });\n        }\n        hideLoader();\n      };\n    }   \n}\n\nfunction searchImages(images) {\n       return axios.get(`${BASE_URL}`,{params: {\n       key: API_KEY,\n        q: images,\n        type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        page: page,\n        per_page: limit,\n    }}).then(({data}) => data)    \n}\n\nfunction createImagesMarkup (arr) {\n    return arr.map(\n         ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        }) =>\n      `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img\n          class=\"gallery-image\"\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n          width=\"360\"\n        />\n      </a>\n      <div class=\"info-block\">\n        <div class=\"block\">\n          <h2 class=\"title\">Likes</h2>\n          <p class=\"amount\">${likes}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Views</h2>\n          <p class=\"amount\">${views}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Comments</h2>\n          <p class=\"amount\">${comments}</p>\n        </div>\n        <div class=\"block\">\n          <h2 class=\"title\">Downloads</h2>\n          <p class=\"amount\">${downloads}</p>\n        </div>\n      </div>\n    </li>`\n    ).join('');\n};\n\nfunction showLoader() {\n  if (loader) {\n    loader.style.display = 'block';\n  }\n}\n\nfunction hideLoader() {\n  if (loader) {\n    loader.style.display = 'none';\n  }\n}"],"names":["BASE_URL","API_KEY","form","gallery","loader","loadMoreBtn","page","limit","maxPages","lightbox","SimpleLightbox","hideLoader","handleSearch","event","images","iziToast","showLoader","hits","totalHits","searchImages","createImagesMarkup","handleLoadMore","error","cardSize","axios","data","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}